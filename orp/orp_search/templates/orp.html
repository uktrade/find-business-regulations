{% extends "base.html" %}
{% load service_problem_tags %}
{% load url_replace_tags %}
{% block head_title %}{% if is_paginated %}Page {{current_page}} - {% endif %}{{service_name}}{% endblock %}
{% block service_name %}{{service_name}}{% endblock %}
{% block body_content %}
<div class="govuk-!-padding-top-4"></div>
<div class="govuk-width-container">
  {% if request_exception %}
  {% render_service_problem %}
  {% else %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <h1 class="govuk-heading-xl govuk-!-margin-bottom-4">Find laws and regulations for business</h1>
      <p class="govuk-body-s govuk-!-margin-bottom-7">From: <a href="#"
          class="govuk-link govuk-link--no-visited-state">Department for Business
          and Trade</a></p>

      <p class="govuk-body">
      <p class="govuk-body">Find information to help UK businesses follow regulations.</p>
      <p class="govuk-body">This finder includes UK legislation, guidance from regulators and government and industry
        standards from the British Standards Institute.</p>
      <p class="govuk-body">Search using keywords or use the filters to search by the publishing organisation, document
        types or regulatory area.</p>
      <p class="govuk-body govuk-!-margin-bottom-9">You can also use this dataset and its metadata as an application
        programming interface
        (API).</p>
    </div>
  </div>

  <form method="get" class="search-form">
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-one-third">
        <div class="govuk-form-group {% if form.search.errors %}govuk-form-group--error{% endif %} search-group">
          <label class="govuk-label" for="{{ form.search.id_for_label }}">
            {{ form.search.label }}
          </label>
          <div class="search-input-button">
            {{ form.search }}
            <button type="submit" class="search__button"></button>
          </div>
        </div>
        <div class="govuk-form-group {% if form.document_type.errors %}govuk-form-group--error{% endif %}">
          <fieldset class="govuk-fieldset">
            <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
              <h2 class="govuk-fieldset__heading">
                Document type
              </h2>
            </legend>
            <!-- <div id="document_type-hint" class="govuk-hint govuk-!-font-size-14">
                1 selected
              </div> -->
            <div class="govuk-checkboxes govuk-checkboxes--small" data-module="govuk-checkboxes">
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="document_type" name="document_type" type="checkbox"
                  value="legislation" {% if 'legislation' in form.document_type.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="document_type">
                  Legislation
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="document_type-2" name="document_type" type="checkbox"
                  value="guidance" {% if 'guidance' in form.document_type.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="document_type-2">
                  Guidance
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="document_type-3" name="document_type" type="checkbox"
                  value="standard" {% if 'standard' in form.document_type.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="document_type-3">
                  British Standards
                </label>
              </div>
            </div>
          </fieldset>
        </div>
        <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
        <div class="govuk-form-group {% if form.published_by.errors %}govuk-form-group--error{% endif %}">
          <fieldset class="govuk-fieldset">
            <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
              <h2 class="govuk-fieldset__heading">
                Published by
              </h2>
            </legend>

            <!-- JAVASCRIPT ENHANCEMENT -->
            <!-- <div id="status-hint" class="govuk-hint govuk-!-font-size-14">
                1 selected
              </div> -->
            <!-- <div class="govuk-form-group {% if form.search.errors %}govuk-form-group--error{% endif %} search-group"> -->
            <!-- <label class="govuk-label govuk-visually-hidden" for="{{ form.search.id_for_label }}">
                Search by publisher
              </label> -->
            <!-- <div class="search-input-button search-input-button--black orp-publisher-search">
                <input class="govuk-input orp-publisher-search__input app-site-search__input--default"
                  name="input-autocomplete" placeholder="Search" type="text" role="combobox">
              </div> -->
            <!-- </div> -->
            <!-- <div class="govuk-checkboxes govuk-checkboxes--small orp-max-height-250" data-module="govuk-checkboxes"> -->
             <!-- /JAVASCRIPT ENHANCEMENT -->

            <div class="govuk-checkboxes govuk-checkboxes--small" data-module="govuk-checkboxes">
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher" name="publisher" type="checkbox"
                  value="healthandsafetyexecutive" {% if 'healthandsafetyexecutive' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher">
                  Health and Safety Executive
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher-2" name="publisher" type="checkbox"
                  value="civilaviationauthority" {% if 'civilaviationauthority' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher-2">
                  Civil Aviation Authority
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher-3" name="publisher" type="checkbox"
                  value="environmentagency" {% if 'environmentagency' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher-3">
                  Environment Agency
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher-4" name="publisher" type="checkbox" value="defra"
                  {% if 'defra' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher-4">
                  Defra
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher-5" name="publisher" type="checkbox"
                  value="officeofgasandelectricitymarkets" {% if 'officeofgasandelectricitymarkets' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher-5">
                  Office of Gas and Electricity Markets
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher-6" name="publisher" type="checkbox"
                  value="officeofrailandroad" {% if 'officeofrailandroad' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher-6">
                  Office of Rail and Road
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher-7" name="publisher" type="checkbox"
                  value="naturalengland" {% if 'naturalengland' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher-7">
                  Natural England
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher-8" name="publisher" type="checkbox"
                  value="historicengland" {% if 'historicengland' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher-8">
                  Historic England
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher-9" name="publisher" type="checkbox"
                  value="nationalhighways" {% if 'nationalhighways' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher-9">
                  National Highways
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher-10" name="publisher" type="checkbox"
                  value="homesengland" {% if 'homesengland' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher-10">
                  Homes England
                </label>
              </div>
              <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="publisher-11" name="publisher" type="checkbox"
                  value="departmentfortransport" {% if 'departmentfortransport' in form.publisher.value %}checked{% endif %}>
                <label class="govuk-label govuk-checkboxes__label" for="publisher-11">
                  Department for Transport
                </label>
              </div>
            </div>
          </fieldset>
        </div>
        <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
        <button class="govuk-button">
          Filter results
        </button>
        <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
        <p class="govuk-body">
          <a id="download-csv-link" href="download_csv/?{{ request.META.QUERY_STRING }}"
            class="govuk-link govuk-link--no-visited-state govuk-!-float-right">Download search results as CSV
            file</a>
        </p>
      {% comment %} </form> {% endcomment %}
    </div>

    <div class="govuk-grid-column-two-thirds">
      <div class="orp-flex orp-flex--space-between">
        <p class="govuk-body govuk-!-font-weight-bold govuk-!-margin-bottom-0">
          {% if results %}
            {% if is_paginated %}
              {{ start_index }} to {{ end_index }} of
            {% endif %}
            {{ results_total_count }} documents
          {% endif %}
        </p>
        <p class="govuk-body govuk-!-margin-bottom-0">
          <a href="/?search=" class="govuk-link govuk-link--no-visited-state
              ">Clear all filters</a>
        </p>
      </div>

      <!-- COMMENTING OUT APPLIED FILTERS HEADER FOR NOW -->
      <!-- <ul class="orp-applied-filters-container">
        <li class="orp-applied-filter-tag">
          <a href="#delete">
            <span class="govuk-visually-hidden">Remove filter:</span>
            <span class="govuk-body-s">Legislation</span>
          </a>
        </li>
        <li class="orp-applied-filter-tag">
          <a href="#delete">
            <span class="govuk-visually-hidden">Remove filter:</span>
            <span class="govuk-body-s">Accreditation Service</span>
          </a>
        </li>
      </ul> -->

      <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">

      {% if results %}
        <div class="govuk-grid-row">
          <div class="govuk-grid-column-full">
            <div class="orp-flex">
              <label class="govuk-label govuk-!-margin-right-3 orp-!-no-text-wrap" for="{{ form.search.id_for_label }}">
                {{ form.sort.label }}
              </label>
              {{ form.sort }}
            </div>
          </div>
        </div>
        <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
      {% endif %}

      <div class="govuk-grid-row">
        <div class="govuk-grid-column-full">
          {% if results %}
          <div class="govuk-summary-list orp-search-results">
            {% for result in results %}
            <div class="govuk-summary-list__row--no-border">
              <span class="govuk-caption-m">{{ result.type }}</span>
              <h2 class="govuk-heading-m">
                <a href="/document/{{ result.id }}" class="govuk-link">
                  {{result.title}}
                </a>
              </h2>
              <p class="govuk-body-m">
                {{result.description}}
              </p>

              <p class="govuk-body-s orp-secondary-text-colour govuk-!-margin-bottom-2">
                Published by: {{ result.publisher}}
              </p>
              <p class="govuk-body-s orp-secondary-text-colour">
                Last updated: {{ result.date_modified }}
              </p>
              <ul class="govuk-list orp-topics-list">
                {% for topic in result.regulatory_topics %}
                <li class="govuk-body-s orp-secondary-text-colour">{{ topic }}</li>
                {% endfor %}
              </ul>
            </div>
            <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
            {% endfor %}
          </div>
          {% if is_paginated %}
          <nav class="govuk-pagination" role="navigation" aria-label="Pagination">
            {% if results.has_previous %}
            <div class="govuk-pagination__prev">
              <a class="govuk-link govuk-pagination__link govuk-link--no-visited-state" href="?{% url_replace request 'page' results.previous_page_number %}">
                <svg class="govuk-pagination__icon govuk-pagination__icon--prev" xmlns="http://www.w3.org/2000/svg" height="13" width="15" aria-hidden="true" focusable="false" viewBox="0 0 15 13">
                  <path d="m6.5938-0.0078125-6.7266 6.7266 6.7441 6.4062 1.377-1.449-4.1856-3.9768h12.896v-2h-12.984l4.2931-4.293-1.414-1.414z"></path>
                </svg>
                <span class="govuk-pagination__link-title">Previous<span class="govuk-visually-hidden"> page</span></span>
              </a>
            </div>
            {% endif %}
            <ul class="govuk-pagination__list">
              {% for page_number in results.paginator.page_range %}
                {% if page_number == results.number %}
                  <li class="govuk-pagination__item govuk-pagination__item--current">
                    <a class="govuk-link govuk-pagination__link govuk-link--no-visited-state" href="?{% url_replace request 'page' page_number %}" aria-current="page">
                      {{ page_number }}
                    </a>
                  </li>
                {% elif page_number == 1 or page_number == results.paginator.num_pages or page_number == results.number|add:"-1" or page_number == results.number|add:"1" %}
                  <li class="govuk-pagination__item">
                    <a class="govuk-link govuk-pagination__link govuk-link--no-visited-state" href="?{% url_replace request 'page' page_number %}">{{ page_number }}</a>
                  </li>
                {% elif page_number == results.number|add:"-2" or page_number == results.number|add:"2" %}
                  <li class="govuk-pagination__item govuk-pagination__item--ellipses">&hellip;</li>
                {% endif %}
              {% endfor %}
            </ul>
            {% if results.has_next %}
              <div class="govuk-pagination__next">
                <a class="govuk-link govuk-pagination__link govuk-link--no-visited-state" href="?{% url_replace request 'page' results.next_page_number %}">
                  <span class="govuk-pagination__link-title">Next<span class="govuk-visually-hidden"> page</span></span>
                  <svg class="govuk-pagination__icon govuk-pagination__icon--next" xmlns="http://www.w3.org/2000/svg" height="13" width="15" aria-hidden="true" focusable="false" viewBox="0 0 15 13">
                      <path d="m8.107-0.0078125-1.4136 1.414 4.2926 4.293h-12.986v2h12.896l-4.1855 3.9766 1.377 1.4492 6.7441-6.4062-6.7246-6.7266z"></path>
                  </svg>
                </a>
              </div>
            {% endif %}
          </nav>
          {% endif %}
          {% else %}
            {% if form.is_bound %}
              <h2 class="govuk-heading-l">There are no matching results</h2>
              <p class="govuk-body-m">
                Improve your search results by:
              </p>
              <ul class="govuk-list govuk-list--bullet">
                <li class="govuk-body-m">
                  removing filters
                </li>
                <li class="govuk-body-m">
                  double-checking your spelling
                </li>
                <li class="govuk-body-m">
                  using fewer keywords
                </li>
                <li class="govuk-body-m">
                  searching for something less specific
                </li>
              </ul>
              <h3 class="govuk-heading-m">Related searches</h2>
              <p class="govuk-body">
                Try these related search terms.
              </p>
              <ul class="govuk-list">
                <li class="govuk-body">
                  <a class="govuk-link" href="/?search=construction+site+safety">construction site safety</a>
                </li>
                <li class="govuk-body">
                  <a class="govuk-link" href="/?search=building+site+safety">building site safety</a>
                </li>
                <li class="govuk-body">
                  <a class="govuk-link" href="/?search=aggregate+use">aggregate use</a>
                </li>
              </ul>
            {% endif %}
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  </form>
</div>
{% endif %}
</div>
{% endblock %}
